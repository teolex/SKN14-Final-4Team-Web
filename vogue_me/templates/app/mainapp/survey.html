<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§„ê²½ AI ì–´ì‹œìŠ¤í„´íŠ¸ ì˜¨ë³´ë”©</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Pretendard Variable", Pretendard;
            background: #F2F7FB;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
            overflow: hidden;
        }

        .container {
            width: 100%;
            max-width: 375px; /* ëª¨ë°”ì¼ ê¸°ë³¸ ì‚¬ì´ì¦ˆ */
            position: relative;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 30px;
        }

        /* íƒœë¸”ë¦¿ ì‚¬ì´ì¦ˆ (768px ì´ìƒ) */
        @media (min-width: 768px) {
            body {
                padding: 24px;
            }
            
            .container {
                max-width: 400px;
            }
        }

        /* ë°ìŠ¤í¬í†± ì‚¬ì´ì¦ˆ (1024px ì´ìƒ) */
        @media (min-width: 1024px) {
            body {
                padding: 32px;
            }
            
            .container {
                max-width: 420px;
            }
        }

        .ai-card {
            background: #3a4a5c;
            border-radius: 20px;
            padding: 12px;
            text-align: center;
            margin: 0;
            width: 100%;
            max-width: 240px;
            height: 280px;
            box-shadow: none;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            position: relative;
            flex-shrink: 0;
        }

        /* íƒœë¸”ë¦¿ì—ì„œ AI ì¹´ë“œ í¬ê¸° ì¡°ì • */
        @media (min-width: 768px) {
            .ai-card {
                max-width: 260px;
                height: 300px;
                padding: 14px;
            }
        }

        /* ë°ìŠ¤í¬í†±ì—ì„œ AI ì¹´ë“œ í¬ê¸° ì¡°ì • */
        @media (min-width: 1024px) {
            .ai-card {
                max-width: 280px;
                height: 320px;
                padding: 16px;
            }
        }

        .ai-card::after {
            content: '';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 320px;
            height: 35px;
            background: radial-gradient(ellipse, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.2) 40%, transparent 80%);
            border-radius: 50%;
            z-index: -1;
        }

        /* íƒœë¸”ë¦¿ì—ì„œ íƒ€ì›í˜• ê·¸ë¦¼ì í¬ê¸° ì¡°ì • */
        @media (min-width: 768px) {
            .ai-card::after {
                width: 340px;
            }
        }

        /* ë°ìŠ¤í¬í†±ì—ì„œ íƒ€ì›í˜• ê·¸ë¦¼ì í¬ê¸° ì¡°ì • */
        @media (min-width: 1024px) {
            .ai-card::after {
                width: 360px;
            }
        }

        .profile-image {
            width: 210px;
            height: 210px;
            border-radius: 20px;
            background: #d4c4a8;
            margin: 0 auto 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            flex-shrink: 0;
        }

        /* íƒœë¸”ë¦¿ì—ì„œ í”„ë¡œí•„ ì´ë¯¸ì§€ í¬ê¸° ì¡°ì • */
        @media (min-width: 768px) {
            .profile-image {
                width: 230px;
                height: 230px;
                border-radius: 22px;
            }
        }

        /* ë°ìŠ¤í¬í†±ì—ì„œ í”„ë¡œí•„ ì´ë¯¸ì§€ í¬ê¸° ì¡°ì • */
        @media (min-width: 1024px) {
            .profile-image {
                width: 250px;
                height: 250px;
                border-radius: 24px;
            }
        }

        .profile-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .ai-name {
            color: white;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            margin-bottom: 0;
        }

        .leaf-icon {
            color: #4ade80;
            font-size: 20px;
        }

        .play-button {
            width: 35px;
            height: 35px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            cursor: pointer;
        }

        .ai-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 210px;
            margin-top: 5px;
        }

        /* íƒœë¸”ë¦¿ì—ì„œ ai-info ë„ˆë¹„ ì¡°ì • */
        @media (min-width: 768px) {
            .ai-info {
                width: 230px;
            }
        }

        /* ë°ìŠ¤í¬í†±ì—ì„œ ai-info ë„ˆë¹„ ì¡°ì • */
        @media (min-width: 1024px) {
            .ai-info {
                width: 250px;
            }
        }

        .play-button::before {
            content: '';
            width: 0;
            height: 0;
            border-left: 12px solid white;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            margin-left: 3px;
        }

        .survey-card {
            background: #3CAA92;
            border-radius: 25px;
            padding: 25px 25px;
            color: white;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            position: relative;
            overflow-y: auto;
            overflow-x: hidden;
            width: 100%;
            height: calc(100vh - 320px);
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
        }

        /* íƒœë¸”ë¦¿ì—ì„œ ì„¤ë¬¸ ì¹´ë“œ íŒ¨ë”© ì¡°ì • */
        @media (min-width: 768px) {
            .survey-card {
                padding: 28px 28px;
                height: calc(100vh - 340px);
            }
        }

        /* ë°ìŠ¤í¬í†±ì—ì„œ ì„¤ë¬¸ ì¹´ë“œ íŒ¨ë”© ì¡°ì • */
        @media (min-width: 1024px) {
            .survey-card {
                padding: 32px 32px;
                height: calc(100vh - 360px);
            }
        }

        .survey-card.complete {
            background: linear-gradient(90deg, #F4D35E 0%, #20A090 100%);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            margin-bottom: 20px;
            display: flex;
            gap: 2px;
            padding: 2px;
        }

        .progress-segment {
            flex: 1;
            height: 100%;
            background: rgba(255,255,255,0.4);
            border-radius: 2px;
            transition: background-color 0.3s ease;
        }

        .progress-segment.filled {
            background: white;
            height: 4px;
        }

        .survey-title {
            font-size: 17px;
            line-height: 1.4;
            margin-bottom: 20px;
            font-weight: 500;
        }

        /* íƒœë¸”ë¦¿ì—ì„œ í…ìŠ¤íŠ¸ í¬ê¸° ì¡°ì • */
        @media (min-width: 768px) {
            .survey-title {
                font-size: 18px;
            }
            
            .option-button {
                font-size: 16px;
                padding: 16px 20px;
            }
        }

        /* ë°ìŠ¤í¬í†±ì—ì„œ í…ìŠ¤íŠ¸ í¬ê¸° ì¡°ì • */
        @media (min-width: 1024px) {
            .survey-title {
                font-size: 19px;
            }
            
            .option-button {
                font-size: 17px;
                padding: 18px 22px;
            }
        }

        .option-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 25px;
        }

        .option-button {
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 14px 18px;
            border-radius: 12px;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .option-button.selected {
            background: white;
            color: #0B1220;
            border-color: white;
            font-weight: 600;
        }

        .option-button:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }

        .option-button.selected:hover {
            background: white;
            transform: translateY(-2px);
        }

        .button-group {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 9px;
            margin-top: auto;
            flex-shrink: 0;
        }

        .nav-button {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .prev-button {
            background: transparent;
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .next-button {
            background: white;
            color: #0B1220;
        }

        .prev-button:hover {
            background: rgba(255,255,255,0.1);
        }

        .next-button:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
        }

        .complete-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .complete-icon {
            font-size: 48px;
            margin-bottom: 0;
        }

        .complete-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 0;
        }

        .complete-subtitle {
            font-size: 16px;
            margin-bottom: 10px;
        }

        /* SurveyCompleteì˜ prev-buttonì—ë§Œ ë” ë„“ì€ í¬ê¸° ì ìš© */
        #surveyComplete .prev-button {
            padding: 12px 30px;
            white-space: nowrap;
        }

        .complete-message {
            font-size: 16px;
            margin-bottom: 30px;
        }

        .input-field {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            background: rgba(255,255,255,0.15);
            color: white;
            font-size: 16px;
            margin-bottom: 30px;
        }

        .input-field::placeholder {
            color: rgba(255,255,255,0.7);
        }

        .input-field:focus {
            outline: none;
            border-color: white;
            background: rgba(255,255,255,0.25);
        }

        .final-button {
            background: white;
            color: #0B1220;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
        }

        .final-button:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
        }

        .hidden {
            display: none;
        }

        /* ê¸°ë³¸ ì• ë‹ˆë©”ì´ì…˜ */
        .survey-card {
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Survey1 íŠ¹ë³„ ì• ë‹ˆë©”ì´ì…˜ - ì¹´ë“œ reveal í›„ì— ë‚˜íƒ€ë‚¨ */
        #survey1 {
            opacity: 0;
            animation: slideUpFromBottom 0.8s ease-out 2.5s both;
        }

        @keyframes slideUpFromBottom {
            from {
                opacity: 0;
                transform: translateY(100vh);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* AI ì¹´ë“œ í”„ë¡œí•„ ì´ë¯¸ì§€ ì¹´ë“œ reveal ì• ë‹ˆë©”ì´ì…˜ (Survey1ì—ì„œë§Œ) */
        .ai-card .profile-image {
            animation: cardReveal 2s ease-in-out 0.5s;
        }

        @keyframes cardReveal {
            0% {
                transform: rotateY(0deg) scale(0.8);
                filter: grayscale(100%) brightness(0.3);
                opacity: 0.5;
            }
            25% {
                transform: rotateY(90deg) scale(0.9);
                filter: grayscale(75%) brightness(0.5);
                opacity: 0.7;
            }
            50% {
                transform: rotateY(180deg) scale(1);
                filter: grayscale(50%) brightness(0.7);
                opacity: 0.9;
            }
            75% {
                transform: rotateY(270deg) scale(1.05);
                filter: grayscale(25%) brightness(0.9);
                opacity: 1;
            }
            100% {
                transform: rotateY(360deg) scale(1);
                filter: grayscale(0%) brightness(1);
                opacity: 1;
            }
        }

        /* AI ì¹´ë“œ ì „ì²´ ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ */
        .ai-card {
            animation: fadeInScale 1s ease-out 0.3s both;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* í­ì£½ ì• ë‹ˆë©”ì´ì…˜ - ì¹´ë“œ ì¶•í•˜ íš¨ê³¼ ì œê±° */
        .survey-card.complete {
            animation: slideUp 0.4s ease-out;
        }

        /* í­ì£½ íŒŒí‹°í´ íš¨ê³¼ - í™”ë ¤í•˜ê²Œ ì—…ê·¸ë ˆì´ë“œ */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            animation: confetti-fall 1.5s linear forwards;
            box-shadow: 0 0 6px rgba(255, 107, 107, 0.6);
        }

        .confetti:nth-child(2n) {
            background: #4ecdc4;
            animation-delay: 0.2s;
            box-shadow: 0 0 6px rgba(78, 205, 196, 0.6);
        }

        .confetti:nth-child(3n) {
            background: #45b7d1;
            animation-delay: 0.4s;
            box-shadow: 0 0 6px rgba(69, 183, 209, 0.6);
        }

        .confetti:nth-child(4n) {
            background: #f9ca24;
            animation-delay: 0.6s;
            box-shadow: 0 0 6px rgba(249, 202, 36, 0.6);
        }

        .confetti:nth-child(5n) {
            background: #f0932b;
            animation-delay: 0.8s;
            box-shadow: 0 0 6px rgba(240, 147, 43, 0.6);
        }

        .confetti:nth-child(6n) {
            background: #eb4d4b;
            animation-delay: 1s;
            box-shadow: 0 0 6px rgba(235, 77, 75, 0.6);
        }

        .confetti:nth-child(7n) {
            background: #6c5ce7;
            animation-delay: 1.2s;
            box-shadow: 0 0 6px rgba(108, 92, 231, 0.6);
        }

        .confetti:nth-child(8n) {
            background: #00d2d3;
            animation-delay: 1.4s;
            box-shadow: 0 0 6px rgba(0, 210, 211, 0.6);
        }

        .confetti:nth-child(9n) {
            background: #ff9ff3;
            animation-delay: 1.6s;
            box-shadow: 0 0 6px rgba(255, 159, 243, 0.6);
        }

        .confetti:nth-child(10n) {
            background: #54a0ff;
            animation-delay: 1.8s;
            box-shadow: 0 0 6px rgba(84, 160, 255, 0.6);
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(0) rotate(0deg) scale(0.8);
                opacity: 0.8;
            }
            30% {
                transform: translateY(120px) rotate(45deg) scale(1);
                opacity: 1;
            }
            60% {
                transform: translateY(240px) rotate(90deg) scale(0.9);
                opacity: 0.7;
            }
            100% {
                transform: translateY(400px) rotate(180deg) scale(0.6);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- AI í”„ë¡œí•„ ì¹´ë“œ -->
        <div class="ai-card">
            <div class="profile-image">
                <img src="{{ image }}" alt="AI ì–´ì‹œìŠ¤í„´íŠ¸ {{ name }}">
            </div>
            <div class="ai-info">
            <div class="ai-name">
                {{ name }} <span class="leaf-icon">ğŸŒ¿</span>
            </div>
            <div class="play-button"></div>
            </div>
        </div>

        <!-- ì„œë² ì´ 1: ì´ˆê¸° ì†Œê°œ -->
        <div id="survey1" class="survey-card">
            <div class="progress-bar">
                <div class="progress-segment filled"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
            </div>
            <div class="survey-title">
                ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” ì¬í™œìš© ì†Œì¬ë¡œ ìŠ¤íƒ€ì¼ì„ ì œì•ˆí•˜ëŠ” LoopLabel AI ì–´ì‹œìŠ¤í„´íŠ¸ ì§„ê²½ì´ì—ìš”.<br><br>
                ì§€êµ¬ë¥¼ ì§€í‚¤ë©´ì„œë„ ë©‹ìŠ¤ëŸ¬ìš´ íŒ¨ì…˜ì„ í•¨ê»˜ ì°¾ì•„ë“œë¦´ê²Œìš”. âœ¨<br><br>
                ì´ì œ ëª‡ ê°€ì§€ ì§ˆë¬¸ìœ¼ë¡œ ë‹¹ì‹ ì˜ ì·¨í–¥ì„ ì•Œì•„ê°€ ë³¼ê²Œìš”. [ì„¤ë¬¸ ì‹œì‘í•˜ê¸°] ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œì‘í•´ë³¼ê¹Œìš”?
            </div>
            <div class="button-group">
                <div></div>
                <button class="nav-button next-button" onclick="nextSurvey()">ì„¤ë¬¸ ì‹œì‘í•˜ê¸°</button>
            </div>
        </div>

        <!-- ì„œë² ì´ 2: ì„±ë³„ -->
        <div id="survey2" class="survey-card hidden">
            <div class="progress-bar">
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
            </div>
            <div class="survey-title">
                ë¨¼ì €, ì–´ë–¤ ì˜· ìŠ¤íƒ€ì¼ì„ ì£¼ë¡œ ì°¾ìœ¼ì„¸ìš”?
            </div>
            <div class="option-group" data-id="gender">
                <div class="option-button" onclick="selectOption(this)" data-value="F">ì—¬ì„±</div>
                <div class="option-button" onclick="selectOption(this)" data-value="M">ë‚¨ì„±</div>
            </div>
            <div class="button-group">
                <button class="nav-button prev-button" onclick="prevSurvey()">ì´ì „</button>
                <button class="nav-button next-button" onclick="nextSurvey()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- ì„œë² ì´ 3: ì—°ë ¹ëŒ€ -->
        <div id="survey3" class="survey-card hidden">
            <div class="progress-bar">
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
            </div>
            <div class="survey-title">
                ì—°ë ¹ëŒ€ë¥¼ ì•Œë ¤ì£¼ì‹œë©´, ë” ì˜ ë§ëŠ” ìŠ¤íƒ€ì¼ì„ ì œì•ˆë“œë¦´ ìˆ˜ ìˆì–´ìš”.
            </div>
            <div class="option-group" data-id="age">
                <div class="option-button" onclick="selectOption(this)" data-value="20ëŒ€">20ëŒ€</div>
                <div class="option-button" onclick="selectOption(this)" data-value="30ëŒ€">30ëŒ€</div>
                <div class="option-button" onclick="selectOption(this)" data-value="40ëŒ€ ì´ìƒ">40ëŒ€ ì´ìƒ</div>
            </div>
            <div class="button-group">
                <button class="nav-button prev-button" onclick="prevSurvey()">ì´ì „</button>
                <button class="nav-button next-button" onclick="nextSurvey()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- ì„œë² ì´ 4: ìŠ¤íƒ€ì¼ ê°€ì´ë“œ -->
        <div id="survey4" class="survey-card hidden">
            <div class="progress-bar">
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
            </div>
            <div class="survey-title">
                í‰ì†Œ ì¢‹ì•„í•˜ëŠ” ìŠ¤íƒ€ì¼ í‚¤ì›Œë“œë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.
            </div>
            <div class="option-group" data-id="style">
                <div class="option-button" onclick="selectOption(this)" data-value="minimal">ë¯¸ë‹ˆë©€ (ê¹”ë”, ì‹¬í”Œ)</div>
                <div class="option-button" onclick="selectOption(this)" data-value="casual">ìºì¥¬ì–¼ (í¸ì•ˆ, ë°ì¼ë¦¬)</div>
                <div class="option-button" onclick="selectOption(this)" data-value="formal">í¬ë©€ (ì •ì¥, ë‹¨ì •)</div>
                <div class="option-button" onclick="selectOption(this)" data-value="feminine">í˜ë¯¸ë‹Œ (ë¶€ë“œëŸ½ê³  ì—¬ì„±ìŠ¤ëŸ¬ì›€)</div>
                <div class="option-button" onclick="selectOption(this)" data-value="street">ìŠ¤íŠ¸ë¦¬íŠ¸ (íŠ¸ë Œë””, ììœ ë¶„ë°©)</div>
            </div>
            <div class="button-group">
                <button class="nav-button prev-button" onclick="prevSurvey()">ì´ì „</button>
                <button class="nav-button next-button" onclick="nextSurvey()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- ì„œë² ì´ 5: ì„ í˜¸í•˜ëŠ” ì†Œì¬ -->
        <div id="survey5" class="survey-card hidden">
            <div class="progress-bar">
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
            </div>
            <div class="survey-title">
                íŠ¹ë³„íˆ ì„ í˜¸í•˜ëŠ” ì†Œì¬ê°€ ìˆë‚˜ìš”?
            </div>
            <div class="option-group" data-id="material">
                <div class="option-button" onclick="selectOption(this)" data-value="recycled polyester">ì¬í™œìš© í”Œë¦¬ì—ìŠ¤í„° (rPET)</div>
                <div class="option-button" onclick="selectOption(this)" data-value="organic cotton">ì˜¤ê°€ë‹‰ ì½”íŠ¼</div>
                <div class="option-button" onclick="selectOption(this)" data-value="recycled wool/nilon">ë¦¬ì‚¬ì´í´ ìš¸/ë‚˜ì¼ë¡ </div>
                <div class="option-button" onclick="selectOption(this)" data-value="no preference">íŠ¹ë³„íˆ ì—†ìŒ, ë‹¤ì–‘í•œ ì†Œì¬ ì¢‹ì•„ìš”</div>
            </div>
            <div class="button-group">
                <button class="nav-button prev-button" onclick="prevSurvey()">ì´ì „</button>
                <button class="nav-button next-button" onclick="nextSurvey()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- ì„œë² ì´ ì™„ë£Œ -->
        <div id="surveyComplete" class="survey-card complete hidden">
            {% csrf_token %}
            <div class="progress-bar">
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
                <div class="progress-segment"></div>
            </div>
            <div class="complete-header">
            <div class="complete-icon">ğŸ‰</div>
            <div class="complete-title">ì„¤ë¬¸ ì™„ë£Œ!</div>
            </div>
            <div class="complete-subtitle">
                ìš°ë¦¬ ë” ì¹œí•´ì§€ë ¤ë©´, ì œê°€ ë­ë¼ê³  ë¶ˆëŸ¬ë“œë¦¬ë©´ ì¢‹ì„ê¹Œìš”?
            </div>
            <div class="complete-message">
                ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ë©´ ë°”ë¡œ ëŒ€í™”ê°€ ì´ì–´ì ¸ìš” ğŸ˜
            </div>
            <input type="text" class="input-field" name="nickname" placeholder="ë‹‰ë„¤ì„ì„ ì•Œë ¤ì£¼ì„¸ìš” ğŸ’š">
            <div class="button-group">
                <button class="nav-button prev-button" onclick="prevSurvey()">ë‚˜ì¤‘ì—</button>
                <button class="final-button" onclick="completeSurvey()">ì™„ë£Œ</button>
            </div>
        </div>
    </div>

    <script>
        let currentSurvey = 1;
        const totalSurveys = 6; // ì™„ë£Œ í™”ë©´ í¬í•¨

        function updateProgressBar() {
            // ëª¨ë“  progress segmentì—ì„œ filled í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.progress-segment').forEach(segment => {
                segment.classList.remove('filled');
            });
            
            // í˜„ì¬ surveyì— ë§ê²Œ filled í´ë˜ìŠ¤ ì¶”ê°€
            const currentCard = document.getElementById(`survey${currentSurvey}`) || document.getElementById('surveyComplete');
            if (currentCard) {
                const progressSegments = currentCard.querySelectorAll('.progress-segment');
                // í˜„ì¬ í˜ì´ì§€ ë²ˆí˜¸ë§Œí¼ filled í´ë˜ìŠ¤ ì¶”ê°€
                for (let i = 0; i < currentSurvey; i++) {
                    if (progressSegments[i]) {
                        progressSegments[i].classList.add('filled');
                    }
                }
            }
        }

        function createConfetti() {
            const surveyCard = document.querySelector('#surveyComplete');
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#f0932b', '#eb4d4b', '#6c5ce7', '#00d2d3', '#ff9ff3', '#54a0ff'];
            
            if (!surveyCard) return;
            
            // survey-cardì˜ ìœ„ì¹˜ì™€ í¬ê¸° ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            const cardRect = surveyCard.getBoundingClientRect();
            const cardLeft = cardRect.left;
            const cardWidth = cardRect.width;
            const cardTop = cardRect.top;
            const cardHeight = cardRect.height;
            
            // ì”ì”í•œ íŒŒí‹°í´ ê°œìˆ˜ë¡œ ì¡°ì • (ì–‘ ëŠ˜ë¦¼)
            for (let i = 0; i < 40; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                
                // survey-card ì˜ì—­ ë‚´ì—ì„œë§Œ ëœë¤í•˜ê²Œ ë¶„ì‚°
                const randomLeft = cardLeft + Math.random() * cardWidth;
                const randomTop = cardTop + Math.random() * (cardHeight * 0.2); // ìƒë‹¨ 20% ì˜ì—­ì—ì„œ ì‹œì‘
                
                confetti.style.position = 'fixed';
                confetti.style.left = randomLeft + 'px';
                confetti.style.top = randomTop + 'px';
                
                const color = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.background = color;
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                confetti.style.animationDuration = '2s';
                confetti.style.animationTimingFunction = 'ease-out';
                
                // ì‘ê³  ì”ì”í•œ í¬ê¸°
                const size = Math.random() * 3 + 4; // 4px ~ 7px
                confetti.style.width = size + 'px';
                confetti.style.height = size + 'px';
                
                // ë¶€ë“œëŸ¬ìš´ ëª¨ì–‘ (ì›í˜• ìœ„ì£¼)
                const shapes = ['border-radius: 50%', 'border-radius: 50%', 'border-radius: 0', 'border-radius: 50%'];
                const randomShape = shapes[Math.floor(Math.random() * shapes.length)];
                confetti.style.cssText += randomShape;
                
                // ë¶€ë“œëŸ¬ìš´ ê¸€ë¡œìš° íš¨ê³¼
                confetti.style.boxShadow = `0 0 4px ${color}60, 0 0 8px ${color}30`;
                
                document.body.appendChild(confetti);
                
                // 2.5ì´ˆ í›„ íŒŒí‹°í´ ì œê±°
                setTimeout(() => {
                    if (confetti.parentNode) {
                        confetti.parentNode.removeChild(confetti);
                    }
                }, 2500);
            }
        }

        function nextSurvey() {
            // Survey 1ì€ ì„ íƒ ê²€ì¦ ì—†ì´ ì§„í–‰
            if (currentSurvey === 1) {
                if (currentSurvey < totalSurveys) {
                    document.getElementById(`survey${currentSurvey}`).classList.add('hidden');
                    currentSurvey++;
                    updateProgressBar();
                    
                    if (currentSurvey === totalSurveys) {
                        document.getElementById('surveyComplete').classList.remove('hidden');
                        setTimeout(() => {
                            createConfetti();
                        }, 1000);
                    } else {
                        document.getElementById(`survey${currentSurvey}`).classList.remove('hidden');
                        updateNextButton(); // ìƒˆ í˜ì´ì§€ì˜ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
                    }
                }
                return;
            }
            
            // Survey 2-5: ì„ íƒ ê²€ì¦
            const currentCard = document.querySelector('.survey-card:not(.hidden)');
            const selectedOptions = currentCard.querySelectorAll('.option-button.selected');
            
            if (selectedOptions.length === 0) {
                alert('ì˜µì…˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            
            if (currentSurvey < totalSurveys) {
                // í˜„ì¬ ì„œë² ì´ ìˆ¨ê¸°ê¸°
                document.getElementById(`survey${currentSurvey}`).classList.add('hidden');
                
                currentSurvey++;
                
                // progress bar ì—…ë°ì´íŠ¸
                updateProgressBar();
                
                // ë‹¤ìŒ ì„œë² ì´ ë³´ì´ê¸°
                if (currentSurvey === totalSurveys) {
                    document.getElementById('surveyComplete').classList.remove('hidden');
                    // ì™„ë£Œ í˜ì´ì§€ì—ì„œ í­ì£½ íš¨ê³¼ ì‹œì‘
                    setTimeout(() => {
                        createConfetti();
                    }, 1000);
                } else {
                    document.getElementById(`survey${currentSurvey}`).classList.remove('hidden');
                    updateNextButton(); // ìƒˆ í˜ì´ì§€ì˜ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
                }
            }
        }

        function getBirthday(age) {
            age = parseInt(age);
            const year     = (new Date()).getFullYear() - age;
            const birthday = new Date(year + "-01-01");
            return `${birthday.getFullYear()}-01-01`;
        }
        async function saveSurvey() {
            const param     = {};
            const $csrf     = document.getElementsByName("csrfmiddlewaretoken")[0];
            const $selected = [...document.querySelectorAll(".option-button.selected")];
            $selected.forEach((e,i) => {
                let $parent = e.closest(".option-group");
                let data_id = $parent.dataset.id;
                let value   = e.dataset.value;
                switch(data_id) {
                    case "gender"   : param["gender"]          = value;              break;
                    case "age"      : param["birthday"]        = getBirthday(value); break;
                    case "style"    : param["prefer"]          = value;              break;
                    case "material" : param["prefer_material"] = value;              break;
                }
            })
            const $nickname = document.getElementsByName("nickname")[0];
            param["nickname"] = $nickname.value;
            const resp = await fetch("{% url "mainapp:survey" %}", {
                method : "POST",
                cache  : "no-cache",
                headers: { "Content-Type": "application/json", "X-CSRFToken": $csrf.value },
                body: JSON.stringify(param)
            });
            const json = await resp.json();
            return json["status"];
        }

        function prevSurvey() {
            // Survey Complete í˜ì´ì§€ì—ì„œ "ë‚˜ì¤‘ì—" ë²„íŠ¼ í´ë¦­ ì‹œ
            if (currentSurvey === totalSurveys) {
                const success = saveSurvey();
                if( success ) {
                    alert('ë‹‰ë„¤ì„ì€ í”„ë¡œí•„ì—ì„œ ì–¸ì œë“ ì§€ ì„¤ì •í•  ìˆ˜ ìˆì–´ìš”! ğŸ˜Š');
                    // OK ë²„íŠ¼ í´ë¦­ ì‹œ ì±„íŒ… í˜ì´ì§€ë¡œ ì´ë™
                    window.location.href = '/chat';
                } else {
                    alert("í˜ì´ì§€ ìƒˆë¡œ ê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                }
                return;
            }
            
            if (currentSurvey > 1) {
                // í˜„ì¬ ì„œë² ì´ ìˆ¨ê¸°ê¸°
                document.getElementById(`survey${currentSurvey}`).classList.add('hidden');
                
                currentSurvey--;
                
                // progress bar ì—…ë°ì´íŠ¸
                updateProgressBar();
                
                // ì´ì „ ì„œë² ì´ ë³´ì´ê¸°
                document.getElementById(`survey${currentSurvey}`).classList.remove('hidden');
                updateNextButton(); // ì´ì „ í˜ì´ì§€ì˜ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            }
        }

        function selectOption(button) {
            const optionGroup = button.parentElement;
            const allButtons = optionGroup.querySelectorAll('.option-button');
            const currentSurveyId = button.closest('.survey-card').id;

            allButtons.forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');

            /*
            // Survey 2, 3: ë‹¨ì¼ ì„ íƒ
            if (currentSurveyId === 'survey2' || currentSurveyId === 'survey3') {
            allButtons.forEach(btn => btn.classList.remove('selected'));
                button.classList.add('selected');
            }
            // Survey 4, 5: ë‹¤ì¤‘ ì„ íƒ
            else if (currentSurveyId === 'survey4' || currentSurveyId === 'survey5') {
                const buttonText = button.textContent.trim();

                // "íŠ¹ë³„íˆ ì—†ìŒ" ì„ íƒ ì‹œ ë‹¤ë¥¸ ì˜µì…˜ë“¤ ë¹„í™œì„±í™”
                if (buttonText === 'íŠ¹ë³„íˆ ì—†ìŒ, ë‹¤ì–‘í•œ ì†Œì¬ ì¢‹ì•„ìš”') {
                    if (button.classList.contains('selected')) {
                        // ì´ë¯¸ ì„ íƒëœ ìƒíƒœë©´ ì„ íƒ í•´ì œ
                        button.classList.remove('selected');
                        allButtons.forEach(btn => {
                            if (btn !== button) {
                                btn.style.opacity = '1';
                                btn.style.pointerEvents = 'auto';
                            }
                        });
                    } else {
                        // ì„ íƒ
                        allButtons.forEach(btn => {
                            if (btn !== button) {
                                btn.classList.remove('selected');
                                btn.style.opacity = '0.5';
                                btn.style.pointerEvents = 'none';
                            }
                        });
                        button.classList.add('selected');
                    }
                } else {
                    // ë‹¤ë¥¸ ì˜µì…˜ ì„ íƒ ì‹œ "íŠ¹ë³„íˆ ì—†ìŒ" ë¹„í™œì„±í™”
                    const specialButton = Array.from(allButtons).find(btn =>
                        btn.textContent.trim() === 'íŠ¹ë³„íˆ ì—†ìŒ, ë‹¤ì–‘í•œ ì†Œì¬ ì¢‹ì•„ìš”'
                    );

                    if (specialButton && specialButton.classList.contains('selected')) {
                        specialButton.classList.remove('selected');
                        specialButton.style.opacity = '1';
                        specialButton.style.pointerEvents = 'auto';
                    }

                    // í˜„ì¬ ë²„íŠ¼ í† ê¸€
                    button.classList.toggle('selected');
                }
            }
            */

            // ë‹¤ìŒ ë²„íŠ¼ í™œì„±í™”/ë¹„í™œì„±í™” ì²´í¬
            updateNextButton();
        }

        function updateNextButton() {
            const currentCard = document.querySelector('.survey-card:not(.hidden)');
            const nextButton = currentCard.querySelector('.next-button');
            const selectedOptions = currentCard.querySelectorAll('.option-button.selected');
            
            if (selectedOptions.length > 0) {
                nextButton.disabled = false;
                nextButton.style.opacity = '1';
                nextButton.style.cursor = 'pointer';
            } else {
                nextButton.disabled = true;
                nextButton.style.opacity = '0.5';
                nextButton.style.cursor = 'not-allowed';
            }
        }

        function completeSurvey() {
            const nickname = document.querySelector('.input-field').value.trim();
            if (nickname) {
                const success = saveSurvey();
                if( success ) {
                    alert(`${nickname}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤! ì´ì œ ë§ì¶¤ ìŠ¤íƒ€ì¼ ì¶”ì²œì„ ë°›ì•„ë³´ì„¸ìš”! ğŸ‰`);
                    // OK ë²„íŠ¼ í´ë¦­ ì‹œ ì±„íŒ… í˜ì´ì§€ë¡œ ì´ë™
                    window.location.href = '/chat';
                } else {
                    alert("í˜ì´ì§€ ìƒˆë¡œ ê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                }
            } else {
                alert('ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”! ğŸ˜Š');
            }
        }


        // Enter í‚¤ë¡œ ë‹¤ìŒ ë‹¨ê³„ ì´ë™
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                if (currentSurvey === totalSurveys) {
                    completeSurvey();
                } else {
                    nextSurvey();
                }
            }
        });

        // ë‹‰ë„¤ì„ ì…ë ¥ í•„ë“œì—ì„œ Enter í‚¤ ì´ë²¤íŠ¸
        document.addEventListener('keypress', function(e) {
            if (e.target.classList.contains('input-field') && e.key === 'Enter') {
                completeSurvey();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìƒíƒœ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            // Survey 1ì˜ ë‹¤ìŒ ë²„íŠ¼ì€ í•­ìƒ í™œì„±í™”
            const survey1NextButton = document.querySelector('#survey1 .next-button');
            if (survey1NextButton) {
                survey1NextButton.disabled = false;
                survey1NextButton.style.opacity = '1';
                survey1NextButton.style.cursor = 'pointer';
            }
            
            // Survey 2-5ì˜ ë‹¤ìŒ ë²„íŠ¼ì€ ì´ˆê¸°ì— ë¹„í™œì„±í™”
            for (let i = 2; i <= 5; i++) {
                const nextButton = document.querySelector(`#survey${i} .next-button`);
                if (nextButton) {
                    nextButton.disabled = true;
                    nextButton.style.opacity = '0.5';
                    nextButton.style.cursor = 'not-allowed';
                }
            }
            
            // Survey1 í˜ì´ì§€ ë¡œë”© ì‹œ íŠ¹ë³„ ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰
            setTimeout(() => {
                const profileImage = document.querySelector('.profile-image img');
                if (profileImage) {
                    // í”„ë¡œí•„ ì´ë¯¸ì§€ì— ì¹´ë“œ reveal ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ì¶”ê°€
                    profileImage.style.animation = 'cardReveal 2s ease-in-out';
                }
            }, 500);
        });
    </script>
</body>
</html>